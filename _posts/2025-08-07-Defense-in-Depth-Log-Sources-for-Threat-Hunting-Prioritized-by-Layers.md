---
layout: default
title: DiD: Log Coverage
category: Threat-Hunting  # This becomes a main topic in sidebar
---


### Defense-in-Depth Log Sources for Threat Hunting: Prioritized by Layers

Threat hunting thrives on layered visibility—defense-in-depth ensures no single failure exposes everything. Below, I've organized a **comprehensive, exhaustive list** of log sources, drawing from established frameworks (e.g., NIST, MITRE D3FEND) and resources like the Awesome Threat Detection repo, ACSC best practices, and cloud hunting guides. Layers follow a logical flow: **Perimeter** (external threats), **Network** (lateral movement), **Identity** (auth/abuse), **Endpoint/Host** (execution), **Application** (data access), **Cloud/Data** (storage/exfil), and **OT/ICS** (industrial). 

**Prioritization**: 
- **High**: Core for most hunts (e.g., auth anomalies, endpoint behaviors)—collect first.
- **Medium**: Supports pivots (e.g., net flows for C2).
- **Low**: Niche/specialized (e.g., OT for critical infra).

This covers **all major devices/technologies/log types** without gaps—e.g., on-prem, cloud (AWS/Azure/GCP), endpoints (Win/Linux/Mac), and emerging (e.g., container logs). Use SIEM (Splunk/ELK) for correlation.

| Layer | Priority | Devices/Technologies | Key Log Types | Why Prioritize for Hunting? |
|-------|----------|-----------------------|---------------|-----------------------------|
| **Perimeter/External** (First line: Block/Detect inbound threats) | Medium | - Next-Gen Firewalls (NGFW: Palo Alto, Cisco ASA/Firepower, Fortinet)<br>- Web Application Firewalls (WAF: ModSecurity, Cloudflare WAF, F5 BIG-IP)<br>- Email Gateways (Proofpoint, Mimecast, Microsoft Defender for Office 365)<br>- DNS Servers/Proxies (Infoblox, BIND, PowerDNS)<br>- Load Balancers (HAProxy, NGINX)<br>- VPN/Remote Access (Cisco AnyConnect, OpenVPN, Azure AD Proxy)<br>- Edge Routers (Cisco ISR, Juniper SRX) | - Firewall flows/denies (e.g., Palo Alto traffic logs: src/dst IP, ports, threats)<br>- WAF alerts (e.g., OWASP attacks, SQLi/XSS attempts)<br>- Email headers/attachments (e.g., Proofpoint quarantine logs, DKIM/SPF failures)<br>- DNS queries/responses (e.g., BIND query.log: suspicious domains, NXDOMAIN floods)<br>- VPN auth/connects (e.g., AnyConnect session logs: failed logins, split-tunnel bypass)<br>- Proxy access (e.g., Squid access.log: URL fetches, anomalies) | Detects initial access (T1190) and phishing (T1566); pivot to internal lateral. High volume—filter for anomalies like port scans. |
| **Network** (Visibility into traffic/lateral movement) | High | - Switches/Routers (Cisco Catalyst/Nexus, Arista)<br>- Intrusion Detection/Prevention Systems (IDS/IPS: Snort, Suricata)<br>- Network Security Monitoring (NSM: Zeek/Bro, Corelight)<br>- NAC (Cisco ISE, Aruba ClearPass)<br>- Packet Brokers (Gigamon, Keysight)<br>- SD-WAN (VMware Velocloud, Cisco Viptela) | - NetFlow/sFlow (e.g., Cisco: src/dst IP, ports, bytes—hunt C2 beacons)<br>- PCAP/full packets (e.g., Zeek conn.log/http.log: TLS JA3 fingerprints, unusual protocols)<br>- IDS alerts (e.g., Suricata eve.json: signatures for exploits like EternalBlue)<br>- NAC posture (e.g., ISE RADIUS logs: device compliance, rogue access)<br>- DCE-RPC/SMB (e.g., Zeek dce_rpc.log/smb_files.log: lateral via shares)<br>- DHCP/DNS (e.g., dhcp.log: rogue device discovery) | Reveals C2 (T1071) and exfil (T1041); correlate with endpoint for pivots. Essential for hypothesis testing (e.g., anomalous flows). |
| **Identity/Access** (Auth and priv abuse) | High | - Active Directory Domain Controllers (Windows Server)<br>- IAM Systems (Okta, Azure AD, AWS IAM)<br>- MFA/SSO (Duo, Ping Identity)<br>- Kerberos/LDAP Servers (MIT Kerberos, OpenLDAP)<br>- Privilege Management (CyberArk, BeyondCorp)<br>- MDM (Intune, Jamf) | - Auth events (e.g., Windows 4624/4625: logons, Kerberos TGT failures)<br>- Group/policy changes (e.g., 4728/4732: user/group mods, Azure AD sign-ins)<br>- LDAP binds/searches (e.g., 5136: object access like Domain Admins)<br>- MFA prompts (e.g., Duo admin logs: bypass attempts)<br>- Session tokens (e.g., Okta system.log: anomalous geos)<br>- MDM enrollment (e.g., Intune device compliance logs) | Spots escalation (T1068) and golden tickets (T1558); high-fidelity for APTs. Prioritize for zero-trust hunts. |
| **Endpoint/Host** (Execution and behavior) | High | - Workstations/Servers (Windows/Linux/Mac: Dell/HP, AWS EC2)<br>- EDR/AV (CrowdStrike Falcon, Microsoft Defender, Carbon Black)<br>- Containers/VMs (Docker, Kubernetes, VMware ESXi)<br>- Mobile Devices (iOS/Android via MDM) | - Process creation (e.g., Sysmon 1/Windows 4688: cmdline, parent-child)<br>- File/registry changes (e.g., Sysmon 11/13: creations/mods, auditd on Linux)<br>- Auth/priv (e.g., Windows 4672/4673: priv assignments, sudo logs)<br>- EDR alerts (e.g., Falcon process tree: LOLBIN abuse like certutil)<br>- Container runtime (e.g., Docker audit: image pulls, execs)<br>- Mobile: App installs, geolocation (e.g., Jamf inventory logs) | Detects execution (T1059) and persistence (T1547); richest for hypothesis (e.g., anomalous PS). Collect via agents. |
| **Application** (Data access and exploits) | Medium | - Web Servers (IIS, Apache, NGINX)<br>- Databases (SQL Server, MySQL, Oracle)<br>- Apps (Office 365, Salesforce, custom SaaS)<br>- CI/CD Pipelines (Jenkins, GitLab)<br>- APIs (REST/GraphQL gateways) | - Access/error logs (e.g., IIS W3C: HTTP 403s, SQLi attempts)<br>- Audit trails (e.g., SQL Server audit: queries, failed logins)<br>- App events (e.g., O365 unified audit: file shares, mailbox rules)<br>- Pipeline builds (e.g., Jenkins audit: code changes, secrets exposure)<br>- API calls (e.g., GraphQL resolvers: anomalous queries) | Uncovers app exploits (T1190) and data theft (T1530); correlate with net for exfil. Medium vol—focus on anomalies. |
| **Cloud/Data** (Storage and exfil) | High (for hybrid) | - Cloud Platforms (AWS S3/EC2, Azure Blob/VM, GCP Storage/Compute)<br>- DLP (Symantec, Forcepoint)<br>- SIEM/Storage (Splunk, ELK)<br>- Backup Systems (Veeam, Rubrik) | - Audit trails (e.g., AWS CloudTrail: API calls, IAM changes; Azure AD: sign-ins)<br>- Flow/VPC logs (e.g., AWS VPC Flow: traffic denies; GCP Audit: policy mods)<br>- DLP alerts (e.g., Symantec incidents: sensitive data copies)<br>- Backup events (e.g., Veeam job logs: ransomware encrypts)<br>- Object access (e.g., S3 bucket logs: unauthorized gets) | Catches exfil (T1537) and misconfigs (T1078.004); high for cloud-first. Prioritize IAM/flow logs. |
| **OT/ICS** (Industrial control) | Low (unless critical) | - PLCs/SCADA (Siemens S7, Rockwell Allen-Bradley)<br>- Historians (OSIsoft PI, AspenTech)<br>- HMI Panels (Wonderware)<br>- Industrial Firewalls (Tofino, Hirschmann) | - Protocol comms (e.g., Modbus/DNP3 logs: anomalous commands)<br>- Safety/availability (e.g., PI tags: setpoint changes)<br>- Config changes (e.g., HMI audit: unauthorized access)<br>- OT firewall (e.g., Tofino events: protocol violations) | Detects sabotage (T0816); low vol but high impact—hunt for protocol anomalies. Integrate with Purdue model. |

This framework ensures **full coverage**: Perimeter blocks entry, network tracks movement, identity guards keys, endpoint sees actions, apps/data protect assets, OT secures ops, cloud handles scale. Start with High-priority (80/20 rule: 80% threats in endpoint/identity/net). For implementation, use Sigma rules for normalization. Customize by env (e.g., add Zeek for net-heavy). What's your top layer to deep-dive?
